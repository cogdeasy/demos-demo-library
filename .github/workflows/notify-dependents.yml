name: Notify Dependent Services

on:
  pull_request:
    types: [closed]
    branches: [main]

jobs:
  trigger-service-updates:
    if: github.event.pull_request.merged == true
    runs-on: ubuntu-latest
    steps:
      - name: Create issue in service repo to trigger Devin
        env:
          GH_TOKEN: ${{ secrets.CROSS_REPO_TOKEN }}
        run: |
          PR_NUMBER="${{ github.event.pull_request.number }}"
          PR_TITLE="${{ github.event.pull_request.title }}"
          PR_URL="${{ github.event.pull_request.html_url }}"
          
          gh issue create \
            --repo cogdeasy/demos-demo-service \
            --title "chore: update demos-demo-library (from PR #${PR_NUMBER})" \
            --body "@devin-ai-integration 

## Library Update Required

A library PR was merged to cogdeasy/demos-demo-library:
- **PR**: #${PR_NUMBER} - ${PR_TITLE}
- **Link**: ${PR_URL}

## Task
1. Update the library version in pom.xml to the latest version
2. Check the library PR description for any new configuration properties
3. Add any new config properties to application.properties or application.yml
4. If there are feature toggles, add them disabled by default
5. Run tests to verify the update works
6. Create a PR with the changes

## Library PR Description
${{ github.event.pull_request.body }}"
